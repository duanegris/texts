
JAVACC=javac -Xlint:deprecation
JAR=jar

MAIN_SRC=ShortestPath
DIR_CLASSES=shortestpath_classes  # a dir to store classes and not mix too many files with sources

HADOOP_LIBS=\
	${HADOOP_HOME}/hadoop-core-${HADOOP_VERSION}.jar:${HADOOP_HOME}/lib/commons-cli-1.2.jar
LOGGING_LIB=commons-logging-1.2.jar

# for 2.4.0
#HADOOP_LIBS=\
#/usr/local/Cellar/hadoop/2.4.0/libexec/share/hadoop/common/hadoop-common-2.4.0.jar:/usr/local/Cellar/hadoop/2.4.0//libexec/share/hadoop/mapreduce/hadoop-mapreduce-client-core-2.4.0.jar

all: shortestpath.jar

shortestpath.jar: $(MAIN_SRC).class 
	$(JAR) -cvf $@ -C $(DIR_CLASSES) .
	@echo "* JAR READY *"
	@echo "-> run with 'hadoop jar $@ $(MAIN_SRC) input output' (make sure you have 'input' and 'output' does not exist yet)"

$(MAIN_SRC).class: $(MAIN_SRC).java
	mkdir -p $(DIR_CLASSES)
	$(JAVACC) -classpath $(HADOOP_LIBS):$(LOGGING_LIB):. -d $(DIR_CLASSES) $<

