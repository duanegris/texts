<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>Introduction Ã  JXTA</title>
<!-- metadata -->
<meta name="generator" content="S5" />
<meta name="version" content="S5 1.1" />
<meta name="presdate" content="20050128" />
<meta name="author" content="S. Genaud" />
<meta name="company" content="UniversitÃ© Louis Pasteur" />
<!-- configuration parameters -->
<meta name="defaultView" content="slideshow" />
<meta name="controlVis" content="hidden" />
<!-- style sheet links -->
<link rel="stylesheet" href="ui/default/slides.css" type="text/css" media="projection" id="slideProj" />
<link rel="stylesheet" href="ui/default/outline.css" type="text/css" media="screen" id="outlineStyle" />
<link rel="stylesheet" href="ui/default/print.css" type="text/css" media="print" id="slidePrint" />
<link rel="stylesheet" href="ui/default/opera.css" type="text/css" media="projection" id="operaFix" />
<!-- embedded styles -->
<style type="text/css" media="all">
.imgcon {width: 525px; margin: 0 auto; padding: 0; text-align: center;}
#anim {width: 270px; height: 320px; position: relative; margin-top: 0.5em;}
#anim img {position: absolute; top: 42px; left: 24px;}
img#me01 {top: 0; left: 0;}
img#me02 {left: 23px;}
img#me04 {top: 44px;}
img#me05 {top: 43px;left: 36px;}

.important { color : red; }

table.list { border-spacing : 3px; 
             margin-left: auto; 
             margin-right : auto; /* pour centrer la table */ 
           }
tr.list    { background-color : #eee59a; font : fixed; }
th.list    { background-color : #c2ddeb; }
td.list    { background-color : #eee59a; margin : 3px; 
        font-family : courier ; font-size : 12pt;}

.listing pre {
           padding: 0; margin: 0;
           background-color : #c2ddeb;
           font-size : smaller;
           border-bottom: 1px solid #000;
           border-top   : 1px solid #000;
           width: 100%; position: relative;
}
.listing-normal pre {
           padding: 0; margin: 0;
           background-color : #c2ddeb;
           border-bottom: 1px solid #000;
           border-top   : 1px solid #000;
           width: 100%; position: relative;
}
</style>


<!-- S5 JS -->
<script src="ui/default/slides.js" type="text/javascript"></script>
</head>
<body>

<div class="layout">
<div id="controls"><!-- DO NOT EDIT --></div>
<div id="currentSlide"><!-- DO NOT EDIT --></div>
<div id="header"></div>
<div id="footer">
<h1>Mars &#8226; 2008</h1>
<h2>Introduction Ã  JXTA</h2>
<h2></h2>
</div>
</div>


<div class="presentation">   <!-- jusqu'a la fin -->


<div class="slide">
<h1>Introduction Ã  JXTA</h1>
<h4><a href="http://icps.u-strasbg.fr/~genaud">StÃ©phane Genaud</a></h4>
</div>


<!-- ________________________ GÃ©nÃ©ral P2P_____________________________ -->

<div class="slide">
<h1>Les bienfaits du P2P</h1>

<ul>
<li>Les systÃ¨mes P2P (contoversÃ©s lÃ©galement) connaissent un succÃ¨s Ã©norme:<br/>
    bittorrent, Kazaa, Gnutella, eDonkey, ...</li>
<li>DÃ©montrent l'utilisation efficace du rÃ©seau.</li>
<li>DÃ©montrent un coÃ»t d'administration minimum.</li>
<li>DÃ©montrent que le partage de fichiers passe trÃ¨s bien Ã  l'Ã©chelle (i.e. beaucoup d'utilisateurs ne dÃ©gradent pas les performances)</li>
</ul>
</div>
 
<!-- ________________________ GÃ©nÃ©ral P2P_____________________________ -->

<div class="slide">
<h1>Les bienfaits du P2P</h1>

<p>
La dÃ©couverte de ces vertus a donnÃ© l'idÃ©e de les transposer Ã  d'autres applications.
</p>
<p>
Le modÃ¨le du client-serveur omni-prÃ©sent dans les systÃ¨mes distribuÃ©s est remis en question.
</p>
<p>
La question : <i>"Quelles propriÃ©tÃ©s des P2P peuvent convenir Ã  un type d'application"</i> n'est pas mÃ»re.
</p>
<ul>
  <li>Le concept du pair rend les Ã©lÃ©ments <b>autonomes</b>, le systÃ¨me plus <b>robuste</b>,</li> 
   <li>mais l'autonomie implique une <b>incertitude</b> (existence d'une rÃ©ponse, temps de rÃ©ponses)</li>
</ul>
</div>
 

<!-- ________________________ GÃ©nÃ©ral _____________________________ -->
<div class="slide">
<h1>Contexte du projet JXTA</h1>
<ul>
	  <li> LancÃ© et financÃ© par Sun Microsystems (mi 2001),</li>
<li> TrÃ¨s actif (<a href="http://www.jxta.org/">http://www.jxta.org/</a> ou <a href="http://jxta.dev.java.net/">http://jxta.dev.java.net</a>).</li>
<li> Ensemble de protocoles pour des applications Peer-to-peer.</li>
<li> Plusieurs implÃ©mentations (Java, C).</li>
<li> Open-source, licence de type Apache Software License.</li>
<li> Aujourd'hui : version JXTA JSE 2.5, JXTA-C 2.5.1 </li>
</ul> 
</div>


<!-- ________________________ Protocols _____________________________ -->
<div class="slide">
<h1>Les protocoles JXTA</h1>

<p>
Les protocoles dÃ©finissent des <span class="important">formats de messages</span> 
XML qui dÃ©crivent les entitÃ©s d'un systÃ¨me pair-Ã -pair et les procÃ©dures.
Ces protocoles dÃ©crivent:
</p>
<ul>
    <li> Comment signaler l'existence d'une ressource,</li>
    <li> Comment rechercher de l'information sur ce rÃ©seau (type de requÃªte),</li>
    <li> Comment mettre en relation producteurs et fournisseurs d'information,</li> 
    <li> Commment Ã©tablir un canal de communication entre plusieurs pairs.</li>
</ul>
</div>
	  
<!-- ________________________ prÃ©ambule : composants du systÃ¨me _____________________________ -->
<div class="slide">
<h1>Composant d'un systÃ¨me JXTA</h1>

Trois type principaux de Pairs :

<ul>
<li><b>Egde</b> peer : le plus commun, n'a pas de rÃ´le dans la structuration du systÃ¨me, implÃ©mente l'application.</li>
<li><b>Rendez-vous</b> peer : rÃ©solution des requÃªtes de dÃ©couvertes (localisation).</li>
<li><b>Relay</b> peer : Ã©tablit des ponts de communication entre deux ensembles de pairs sÃ©parÃ©s physiquement (e.g. fire-walls).</li>
</ul>

<p>
L'ensemble des pairs est scindÃ© en partitions virtuelles hiÃ©rarchiques appelÃ©es <em>peer groups</em>. 
Limite les communications Ã  l'intÃ©rieur d'un groupe.
L'idÃ©e est de former un groupe pour rÃ©aliser une tÃ¢che.
</p>

</div>


<!-- ________________________ prÃ©ambule : identifiants _____________________________ -->
<div class="slide">
<h1>Identifiants et annonces</h1>

<p>
Les pairs ne sont pas identifiÃ©s par des adresses rÃ©seau car JXTA crÃ©Ã© un rÃ©seau logique sur le rÃ©seau physiquei (<em>overlay</em>).
</p>
<p>
Les ressources (i.e. pairs, groupes, services et pipes) sont reprÃ©sentÃ©s par des <em>advertisements</em> (ou <em>annonces</em>). 
</p>
<p>
Une annonce est un document XML contenant des informations pertinentes vis-Ã -vis du type de ressource (en particulier l'ID de la ressource).
</p>
<p>
Les annonces sont <b>publiÃ©es</b> pour que les autres pairs puissent dÃ©couvrir une ressource. 
</p>
</div>
<div class="handout">

Il faut traiter le cas des ressources qui changent d'adresse physique (e.g. IP dynamique): 
adresse logique nÃ©cessaire.

</div>
<!-- ________________________ Services_____________________________ -->
<div class="slide">
<h1>Services</h1>

<ul>
<li> Un peer group fournit un ensemble de <em>services</em></li>
<li> JXTA dÃ©finit les services essentiels d'un peer group.</li>
<li> Des services supplÃ©mentaires peuvent Ãªtre dÃ©veloppÃ©s.</li>
<li> Pour que deux pairs puissent interagir via un service, ils doivent faire partie du mÃªme peer group.</li>

</ul>

</div>


<div class="slide">
<h1>Services (2/2)</h1>

<p>
Les protocoles sont implÃ©mentÃ©s par des services de base (<em>Core services</em>) de 
toute implÃ©mentation JXTA:
</p>

<ul>
	  <li> le <em>Discovery service</em>: recherche/publication d'annonces.</li>
	  <li> le <em>Rendezvous</em>: placement des annonces.</li>
	  <li> le <em>Resolver</em> service:  formuler requÃªtes et rÃ©ponses.</li>
	  <li> le <em>Pipe</em> service: canal de communication.</li>
	  <li> le <em>EndPoint</em> service: interface rÃ©seau.</li>
	  <li> le <em>Peer Info</em> service: monitoring.</li>
</ul>

</div>

<!-- ________________________ Communication __________________________ -->
<div class="slide">
<h1>Grandes fonctionnalitÃ©s</h1>

Les grandes fonctionnalitÃ©s et leur rÃ©alisation en JXTA:

<ul>
<li>DÃ©couverte: signaler l'existence d'un Ã©lÃ©ment nouveau sur le rÃ©seau, chercher des Ã©lÃ©ments 
particuliers. Protocoles:
   <ul>
     <li>Peer Discovery (manipuler les annonces),</li>
     <li>Peer Resolver (vÃ©hiculer les annonces ou requÃªtes/rÃ©ponses),</li>
     <li>Rendez-vous (placer les annonces),</li>
     <li>Peer Information (monitoring),</li>
   </ul></li>
<li>Communication: communiquer entre deux pairs, ou vers un groupe de pairs. Protocoles:
   <ul>
     <li>Pipe Binding,</li>
     <li>Endpoint Routing,</li>
   </ul></li>
</ul>
</div>


<!-- ________________________ Decouverte 1/_____________________________ -->
<div class="slide">
<h1>DÃ©couverte de ressources</h1>

<p>
Le principe gÃ©nÃ©ral: ne pas chercher directement les ressources, mais les annonces qui
donnent cette information.
</p>

<p>
JXTA procÃ¨de Ã  3 type de recherche d'annonces:
</p>
  <ul>
  <li>recherche <em>locale</em>: recherche dans les annonces mises en cache.</li>
  <li>recherche <em>directe</em>: diffusion de la recherche sur le LAN.</li>
  <li>recherche <em>indirecte</em>: recherche dans un systÃ¨me d'annuaire distribuÃ© (rendezVous).</li>
  </ul> 

</div>

<!-- ________________________ Decouverte - discovery protocol _____________________________ -->
<div class="slide">
<h1>Peer discovery protocol</h1>

<p>
Le protocole Peer Discovery dÃ©finit le format d'une recherche:
</p>

<div class="listing">
<pre>
 &lt;xml version="1.0" encoding="utf-8"?&gt;
 &lt;jxta:DiscoveryQuery&gt;
    &lt;Type&gt; ... &lt;/Type&gt;
    &lt;Threashold&gt; .... &lt;/Threashold&gt;
    &lt;PeerAdv&gt; ... &lt;/PeerAdv&gt;
    &lt;Attr&gt; ... &lt;/Attr&gt;
    &lt;Value&gt; ... &lt;/Value&gt;
 &lt;/jxta:DiscoveryQuery&gt;
</pre>
</div>

<ul>
<li>Type : 0 pour un peer advertissement, 1 peer group advertissement.</li>
<li>Threshold: (optionnel) nombre max d'adverstissements en retour par peer.</li>
<li>Attr,Value: critÃ¨re de sÃ©lection sur l'advertissement recherchÃ©.</li>
</ul>
</div>

<!-- _____________________ Decouverte - discovery protocol ____________________________ -->
<div class="slide">
<h1>Peer discovery protocol</h1>

<p>
Format d'une rÃ©ponse Ã  une recherche:
</p>
<div class="listing">
<pre>
 &lt;xml version="1.0" encoding="utf-8"?&gt;
 &lt;jxta:DiscoveryResponse&gt;
    &lt;Type&gt; ... &lt;/Type&gt;
    &lt;Count&gt; ... &lt;/Count&gt;
    &lt;Threashold&gt; .... &lt;/Threashold&gt;
    &lt;PeerAdv&gt; ... &lt;/PeerAdv&gt;
    &lt;Attr&gt; ... &lt;/Attr&gt;
    &lt;Value&gt; ... &lt;/Value&gt;
    &lt;Response Expiration="delay"&gt; 
        ... 
    &lt;/Response&gt;
 &lt;/jxta:DiscoveryResponse&gt;
</pre>
</div>

<ul>
<li> Count: (optionnel) indique le nombre d'Ã©lÃ©ment <tt>Response</tt> dans le message.  </li>
</ul>
</div>
<!-- ________________________ Decouverte 1/_____________________________ -->
<div class="slide">
<h1>Discovery service</h1>

<p>
Le <em>Discovery Service</em> fournit des mÃ©canismes pour manipuler
les objets du Discovery protocol.
</p>
<ul>
        <li>retrait d'annonces distantes,</li>
        <li>retrait d'annonces conservÃ©es localement (cache),</li>
        <li>publication d'annonces Ã  distance,</li>
        <li>publication d'annonces localement,</li>
        <li>vidange du cache local des annonces.</li>
</ul>

<p>
Un exemple des tutoriaux maintenus par jxta.org montre un exemple
simple de dÃ©couverte.<br/>
Code source java : [ <a href="src/jxta/basic/JxtaAppDemo.java">JxtaAppDemo.java</a> ].
</p> 

</div>


<div class="slide">
<h1>DÃ©couverte de ressources</h1>

<p>
La dÃ©couverte et la publication utilisent le <em>service de dÃ©couverte</em>
qui interroge l'ensemble des rendez-vous (rÃ´le de super-pairs).
</p>
<p>
JXTA utilise des tables de hachage distribuÃ©es (DHT) pour accÃ©lÃ©rer la dÃ©couverte. Quand un pair publie une annonce, une fonction de hachage indique le rendez-vous qui mÃ©morisera l'annonce.
</p>
<p>
Pour fiabiliser le service, rÃ©plication partielle des informations dÃ©tenues par les rendez-vous.
</p>
<p>
Si aucun rendez-vous ne peut rÃ©pondre, passage en mode "walk" : propagation de la requÃªte Ã  travers les pairs (beaucoup plus lent).
</p>
</div>
<!-- ________________________ Decouverte 2/_____________________________ -->
<div class="slide">
<h1>Principe d'une dÃ©couverte</h1>

<img src="img/jxta_discovery.png" title="discovery" alt="discovery"/>


</div>



<!-- ________________________ Communication __________________________ -->
<div class="slide">
<h1>Communication</h1>

JXTA fournit trois niveaux de communications. Du plus bas au plus Ã©levÃ© :
<ul>
<li>Endpoint service : liason abstraite <b>non-fiable</b> et <b>unidirectionnelle</b> entre deux pairs identifiÃ©s par des PeerID. VÃ©hicule des JXTA messages.</li>
<li>Pipe service : canal virtuel construit entre pairs, <b>unidirectionnel</b> et <b>asynchrone</b>, identifiÃ© par un PipeID.Utilise une sÃ©rie de endpoints pour construire la route (vÃ©rifiÃ©e pÃ©riodiquement) </li>
<li>JXTA Socket : mÃªme interface que les sockets Java, <b>fiables</b> et <b>bidirectionnels</b></li>

</ul>
</div>


<!-- ________________________ Communication __________________________ -->
<div class="slide">
<h1>Communication - pipe</h1>

<p>
CrÃ©ation d'un pipe Ã  partir d'un advertisement:
</p>

<div class="listing">
<pre>
PipeService pipe = netPeerGroup.getPipeService();

...
 
FileInputStream is = new FileInputStream("pipexample.adv");
XMLDocument document = (XMLDocument) 
 StructuredDocumentFactory.newStructuredDocument(MimeMediaType.XMLUTF8, is);

PipeAdvertisment pipeAdv = (PipeAdvertisement) 
  AdvertisementFactory.newAdvertisement(document);
  
...

pipe.createOutputPipe(pipeAdv);
</pre>
</div>

<p>
Code source java : [ <a href="src/jxta/pipe/PipeExample.java">PipeExample.java</a> ],
[ <a href="src/jxta/pipe/PipeListener.java">PipeListener.java</a> ]<br/>
advertisement : [ <a href="src/jxta/pipe/pipexample.adv">pipexample.adv</a> ].
</p>

</div>


<!-- ________________________ Communication __________________________ -->
<div class="slide">
<h1>Communication - pipe</h1>

<p>
Ecoute sur un pipe:
</p>

<div class="listing">
<pre>
// crÃ©ation et enregistrement de this comme PipeMsgListener.
// Quand un message arrive pipeMsgEvent est appelÃ©e

   InputPipe pipeIn = pipe.createInputPipe(pipeAdv, this);

public void pipeMsgEvent(PipeMsgEvent event) {

   Message msg = event.getMessage();
   Message.ElementIterator en = msg.getMessageElements();
   ...
}
</pre>
</div>

<p>
Code source java : [ <a href="src/jxta/pipe/PipeExample.java">PipeExample.java</a> ],
[ <a href="src/jxta/pipe/PipeListener.java">PipeListener.java</a> ]<br/>
advertisement : [ <a href="src/jxta/pipe/pipexample.adv">pipexample.adv</a> ].
</p>

</div>
<!-- ________________________ Decouverte 1/_____________________________ -->
<div class="slide">
<h1>Exemple: publication et connexion pipe</h1>

<b>Exemple</b>: <i> comment initier une connexion entre pairs ?</i>
<p>
Chaque pair :
</p>
<ol>
   <li>crÃ©Ã© un output pipe,</li>
   <li>publie l'annonce du pipe,</li>
   <li>se met Ã  la recherche d'output pipes.</li>
</ol>
<p>
Un pair dÃ©couvrant une annonce de pipe (contenant le PipeID) peut crÃ©er un input pipe avec
le pipeID et Ãªtre ainsi reliÃ© au pair ayant publiÃ© l'annonce.
</p>
</div>

<!-- ________________________ Programmation 1/_____________________________ -->
<div class="slide">
<h1>Programmation - DÃ©marrage (Java)</h1>

<ol>
<li> CrÃ©er localement la structure de rattachement au peer group par dÃ©faut: 
  <div class="listing">
  <pre>
  PeerGroup g = PeerGroupFactory.newNetPeerGroup();
  </pre>
  </div>
L'objet <tt>g</tt> contient alors l'implÃ©mentation de rÃ©fÃ©rence des services
(Discovery,Membership,RendezVous,...)
</li>

<li> Construire une annonce identifiant notre groupe en particulier (en l'associant Ã  notre groupe) :
<div class="listing">
<pre>
  PeerAdvertisement a = g.getPeerAdvertisement();
</pre>
</div>
</li>

<li> RÃ©cupÃ©rer le protocole de dÃ©couverte associÃ© Ã  notre groupe
<div class="listing">
<pre>
 DiscoveryService d = g.getDiscoveryService();
</pre>
</div>
</li>
</ol>

</div>
<!-- ________________________ Programmation 1/_____________________________ -->
<div class="slide">
<h1>Programmation - DÃ©marrage (Java)</h1>

Objectif : dÃ©couvrir d'autres pairs 
en utilisant le <a href="http://platform.jxta.org/java/api/net/jxta/discovery/DiscoveryService.html">service de dÃ©couverte</a>.

<p> Indiquer que l'objet courant est un <em>listener</em> : 
il Ã©coute les Ã©vÃ¨nements de type <tt>DiscoveryResponse</tt>.
</p>
     <div class="listing">
     <pre>
     d.addDiscoveryListener(this);  
     </pre>
     </div>
     <p> 
     Le <em>listener</em> impose l'installation d'un gestionnaire 
     pour la rÃ©ception des rÃ©ponse Ã  l'annonce :   
     </p>
     <div class="listing">
     <pre>
      public void discoveryEvent(DiscoveryEvent e) {
           ...
           // code qui fait quelquechose avec e
           ...
      }
     </pre></div>
</div>


<div class="slide">
<h1>Programmation </h1>

<p> Lancer une recherche indirecte (via rendezVous) </p>
<div class="listing">
<pre>   
  d.getRemoteAdvertisements(); 
</pre></div>

<p>
Prototype :
</p>
<div class="listing">
<pre>
int getRemoteAdvertisements(String peerid, 
                            int type, 
                            String attribute, 
                            String value, 
                            int threshold) 
</pre>
</div>


<p>
une annonce est publiÃ©e avec 
</p>
<div class="listing">
<pre>
void 	publish(Advertisement advertisement)
</pre></div>
Publication pendant DEFAULT_LIFETIME


</div>


<!-- ________________________ Programmation 3/_____________________________ -->
<div class="slide">
<h1>Programmation - DÃ©marrage (Java)</h1>
<ul>
<li>  
 Dans le handler, on extrait le message de la rÃ©ponse :    
 <div class="listing">
 <pre>   
  DiscoveryResponseMsg m = e.getResponse();
 </pre></div>
</li>
<li> Le message de la rÃ©ponse contient une annonce :
<div class="listing"><pre> 
  PeerAdvertisment a = m.getPeerAdvertisement();
</pre></div>
</li>
<li> On peut en extraire le nom du peer par exemple:
<div class="listing"><pre>
  name = a.getPeerName();
</pre>
</div>
</li>
</ul>

</div>


<!-- ____________________ FIN ___________________________ -->
</div> <!-- fin presnetation -->
</body>
</html>
